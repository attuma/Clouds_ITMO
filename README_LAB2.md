# Лаб 2

## 1. Плохой Dockerfile 

```dockerfile
# Используем полный образ Python вместо slim
FROM python:3.11

# Копируем код установки библиотек
COPY . /app

# Много отдельных RUN вместо одного с &&
RUN pip install requests
RUN pip install flask
RUN pip install numpy

WORKDIR /app
CMD ["python", "-c", "print('Hello from Docker!')"]
```

---

## 2. Хороший Dockerfile

```dockerfile
# Используем slim вместо полного образа	
FROM python:3.11-slim

WORKDIR /app

# Один RUN вместо 3
RUN pip install --no-cache-dir requests flask numpy

# Копируем после зависимостей 
COPY . /app

CMD ["python", "-c", "print('Hello from Docker!')"]
```

---

## 3. Почему так?

### Ошибка 1: Полный образ Python вместо slim

- В плохом Dockerfile мы используем `FROM python:3.11` (900 MB), это полный образ с много ненужным.
- В хорошем Dockerfile мы используем `FROM python:3.11-slim` (150 MB), это образ только с необходимым. Это изменение уменьшает образ в 6 раз

---

### Ошибка 2: Копируем код перед зависимостями

- В плохом Dockerfile мы сначала копируем весь код `COPY . /app`, а потом устанавливаем библиотеки. Если изменится файл, Docker переустановит все библиотеки заново, а это может занят много времени.
- В хорошем Dockerfile мы сначала устанавливаем библиотеки, а потом копируем код. Благодаря этому кэш библиотек используется, и пересборка меньше времени.

---

### Ошибка 3: Много RUN команд вместо одной

- В плохом Dockerfile мы используем много RUN из-за этого у нас много слоем , а это приводит к тому что больше файлов и кэша в образе
- В хорошем Dockerfile один RUN это делает образ меньше

---

## 4. Плохие практики работы с контейнерами

### Ошибка 1: Хранение данных внутри контейнера

Если мы запустим контейнер, он будет сохранять данные внутри себя. Но когда мы удалим контейнер, все данные исчезнут. Нам нужно использовать volumes, чтобы данные хранились на компьютере, а не в контейнере. Иначе потеряем всё.

---

### Ошибка 2: Менять файлы контейнера вручную

Когда мы вручную меняем файлы, чтобы быстро что-то исправить, мы теряем эти изменения. И если мы работаем в команде, другие разработчики не узнают, что мы поменяли, и у них всё не будет работать. Нужно исправлять через Dockerfile или код, чтобы все видели изменения.
